\section{Binary Black Hole Population Inference with GWTC-3} \label{sec:results}

We use hierarchical Bayesian inference (see Appendix \ref{sec:hierarchical_inference}) to simultaneously infer the astrophysical mass, spin, and redshift distributions of 
binary black holes (BBHs) given a catalog of gravitational wave observations. Following the same cut on the recent GWTC-3 catalog done in the LVK's 
accompanying BBH population analysis, we have 70 possible BBH mergers with false alarm rates less than 1 per year \citep{GWTC3,o3b_astro_dist}. Since it was concluded to be an outlier of the rest of 
the BBH population in both GWTC-2 and GWTC-3, we choose to omit the poorly understood event, GW190814 \citep{190814disc,o3a_pop,o3b_astro_dist,Essick_2022}. This leaves us with 
a catalog of 69 confident BBH mergers, observed over a period of about 2 years, from which we want to infer population properties. Our study provides the first comprehensive 
data-driven investigation of the BBH mass, spin, and redshift distributions, uncovering new insights and corroborating those found with other methods. 
We start with our inference of the mass distribution.

\begin{figure*}[ht!]
    \begin{centering}
        \includegraphics[width=\linewidth]{figures/mass_distribution_plot.pdf}
        \caption{The marginal primary mass distribution inferred with the B-Spline model (red), with 64 knots spaced linearly in $\log m_1$, from 6.5\msun 
        to 100\msun. The solid line shows the population predictive distribution (PPD), and the shaded region 
        the 90\% credible interval. We show the inferred PPD from the \textsc{PowerlawPeak} (blue) and \textsc{PowerlawSpline} (green) models 
        from the LVK's GWTC-3 population analyses \citep{o3b_astro_dist}.}
        \label{fig:mass_distribution}
    \end{centering}
    \script{mass_distribution_plot.py}
\end{figure*}

\subsection{Binary Black Hole Masses} \label{sec:mass_dist}

Figure \ref{fig:mass_distribution} shows the primary mass distribution inferred with our B-Spline model (red), where we see features consistent with those inferred by the \textsc{PowerlawPeak} and \textsc{PowerlawSpline} mass models \citep{Talbot_2018,o3a_pop,Edelman_2022ApJ,o3b_astro_dist}. 
In particular our B-Spline model finds peaks in merger rate density as a function of primary mass at both $\sim10\msun$ and $\sim35\msun$, agreeing with those 
reported using the same dataset in \citet{o3b_astro_dist}. The B-Spline model finds the same feature at $\sim18\msun$ as the \textsc{PowerlawSpline} model, but remains consistent with the \textsc{PowerlawSpline} model; the mass distribution is more uncertain in this region.
We find the largest disagreement at low masses, where the power-law-based models show a higher rate below ${\sim}8-9\msun$. This is partly due to the minimum mass hyperparameter (where the power law ``begins'') serving as the minimum allowable primary and secondary masses of the catalog. This leads to inferences of $m_\mathrm{min}$ below the minimum observed primary mass in the catalog, $\sim 6.4\msun$, to account for secondary BBH masses 
that can possibly get as low as $\sim 3\msun$. We choose a minimum primary mass for 
the B-Spline model to be $6.5\msun$, while secondary masses are enforced to be greater than $3\msun$. The lack of observations of binaries with low primary mass make rate estimates in this region strongly model and prior dependent.  We could be seeing signs of a decrease in merger rate from a ``lower mass gap'' between neutron star and BH masses, or we could be seeing fluctuations due to low-number statistics.  Either way we expect this to be resolved with future catalog updates. We also find no evidence for a sharp fall off in merger rate either following 
the pileup at ${\sim}35\,\msun$ -- expected if such a pileup was due to pulsational pair instability supernovae (PPISNe) -- or where the maximum mass truncation of the power law models 
are inferred. The lack of any high mass truncation, along with the peak at $\sim35\msun$ (significantly lower than expected from PPISNe) may pose challenges for conventional stellar 
evolution theory. This could be hinting at the presence of subpopulations that avoid pair instability supernovae during binary formation, but the confirmation of the existence of such subpopulations 
cannot be determined with the current catalog. 

\begin{figure}[h]
    \includegraphics[width=\linewidth]{figures/q_distribution_plot.pdf}
    \caption{The marginal mass ratio distribution inferred with the B-Spline model (red), with 18 knots spaced linearly in $q$, from 0.03 to 1. The solid line shows the population predictive distribution (PPD), and the shaded region the 90\% credible interval. 
    We show the inferred PPD from the \textsc{PowerlawPeak} (blue) and \textsc{PowerlawSpline} (green) models from the LVK's GWTC-3 population analyses \citep{o3b_astro_dist}.}
    \label{fig:q_distribution}
    \script{q_distribution_plot.py}
\end{figure}

The marginal mass ratio distribution inferred by the B-spline model is shown in figure \ref{fig:q_distribution}.  These results suggest we may be seeing the first signs of departure from a simple power law behavior.  We find a potential plateau or decrease in the merger rate near equal mass ratios, as well as a broader tail towards unequal mass ratios 
than the power law based models find. Our results also suggest a shallower slope from $q\sim0.3$ to $q\sim0.7$, though uncertainty is larger in this region. The sharp decrease in rate just below 
$q\sim0.3$ is due to the minimum mass ratio truncation defined by $q_\mathrm{min}=\frac{m_\mathrm{min}}{m_1}$. When marginalizing over the primary mass 
distribution with a strong peak at $10\msun$, the mass ratio distribution truncates at $q\sim0.3$: the minimum secondary mass, $3\msun$, 
divided by the most common primary mass, ${\sim}10\msun$. 


\subsection{Binary Black Hole Spins} \label{sec:spin_dist}

\begin{figure}
    \begin{centering}    
        \includegraphics[width=\linewidth]{figures/iid_spinmag.pdf}
        \caption{The spin magnitude distribution inferred with the B-Spline model (red) with 16 knots spaced linearly from 0 to 1, assuming the components are IID. The solid line shows the population predictive distribution (PPD), and the shaded region the 90\% credible interval. 
        For comparison we show the inferred PPD from the \textsc{Default} (blue) model from \citet{o3b_astro_dist}, the LVK's GWTC-3 population analyses.}
        \label{fig:iid_spinmag_dist}
    \end{centering}
    \script{plot_iid_spinmag.py}
\end{figure}

\subsubsection{Spin Magnitude}

The \textsc{Default} spin model (used by \citet{o3b_astro_dist}) describes the spin magnitude of both components as identical and independently distributed (IID) non-singular Beta distributions \citep{Talbot_2017,Wysocki_2019}.
The Beta distribution provides a simple 2-parameter model that can produce a wide range of functional forms on the unit interval. However, the constraint that keeps 
the Beta distribution non-singular (i.e. $\alpha>1$ and $\beta>1$) enforces a spin magnitude that always has $p(a_i=0) = 0$. Recent studies have proposed the possible existence of a 
distinct subpopulation of non-spinning or negligibly spinning black holes that can elude discovery with such a model \citep{FullerMa2019,RouletGWTC2Pop,BuildBetterSpinModels,Callister_NoEvidence,GWTC3MonashSpin}. 

\begin{figure} 
    \begin{centering}
        \includegraphics[width=\linewidth]{figures/ind_spinmag.pdf}
        \caption{The primary (orange) and secondary (olive) spin magnitude distributions inferred with the B-Spline model
        with 16 knots spaced linearly from 0 to 1. The solid line shows the population predictive distribution (PPD), and the shaded region the 90\% credible interval. 
        For comparison we show the inferred PPD from the \textsc{Default} (blue) model from \citet{o3b_astro_dist}, the LVK's GWTC-3 population analyses.}
        \label{fig:ind_spinmag_dist}
    \end{centering}
    \script{plot_ind_spinmag.py}
\end{figure}

We model the spin magnitude distributions as IID B-Spline distributions as a check to the assumptions of the \textsc{Default} model. 
Figure \ref{fig:iid_spinmag_dist} shows the inferred spin magnitude distribution with the B-Spline model, compared with the \textsc{Default} model. 
The B-Spline model results are consistent with those using the Beta distribution, peaking near $a\sim0.2$, with 90\% of BBH spins below 
\result{$\CIPlusMinus{\macros[BSplineIIDCompSpins][a_90percentile]}$} at 90\% credibility. The B-Spline model does not impose vanishing support at the extremal values like the Beta distribution, 
allowing it to probe the zero-spin question. We find broad support, with large variance, for non-zero probabilities at $a_i=0$, but cannot confidently determine the presence of 
a significant non-spinning subpopulation, corroborating similar recent conclusions \citep{BuildBetterSpinModels,Callister_NoEvidence,GWTC3MonashSpin}. 
We repeat the same analysis with independent B-Spline distributions for each spin magnitude component. In figure \ref{fig:ind_spinmag_dist} 
we show the inferred primary (orange), and secondary (olive) spin magnitude distributions inferred when relaxing the IID assumption. We find that the primary spin magnitude distribution 
peaks slightly higher, at $a\sim0.25$, than the IID B-Spline model, but with similar support at near vanishing spins. The secondary spin magnitude distribution is more uncertain due to the 
higher measurement uncertainty when inferring the secondary spins of BBH systems. The secondary distribution also peaks at smaller spin magnitudes of $a\sim0.15$, showing potentially rates at $a\sim0$ than the primary distribution or B-Spline IID spin magnitude distribution in figure \ref{fig:iid_spinmag_dist}, though uncertainties are large. While the distributions are broadly consistent, we could be seeing the first signs that component spin magnitude distributions are uniquely distributed. 

\subsubsection{Spin Orientation}

The \textsc{Default} spin model (used by \citet{o3b_astro_dist}) also assumes the spin orientation of both components are identical and independently distributed (IID), with a mixture model over an
aligned and an isotropic component. The aligned component is modeled with a truncated Gaussian distribution with mean at $\cos{\theta}=1$ and variance a free 
hyperparameter to be fit \citep{Talbot_2017,Wysocki_2019,o3a_pop,o3b_astro_dist}. This provides a simple 2-parameter model motivated by simple distributions expected from the two main formation scenario families, allowing 
for a straightforward interpretation of results. One possible limitation however, is that by construction this distribution is forced to peak at perfectly aligned spins, 
i.e. $\cos{\theta}=1$. While this may be a reasonable assumption, \citet{spinitasyoulike} recently extended the model space of parametric descriptions 
used to model the spin orientation distribution and found considerable evidence that the distribution peaks away from $\cos{\theta}=1$. Again, this provides a clear 
use-case where data-driven models can help us understand the population.

\begin{figure}
    \begin{centering}
        \includegraphics[width=\linewidth]{figures/iid_spintilt.pdf}
        \caption{The spin orientation distribution inferred with the B-Spline model (red) with 16 knots spaced linearly from -1 to 1, and assuming the components are IID. The solid line shows the population predictive distribution (PPD), and the shaded region the 90\% credible interval. 
        For comparison, we show the inferred PPD from the \textsc{Default} (blue) model from \citet{o3b_astro_dist}, the LVK's GWTC-3 population analyses.}
        \label{fig:iid_spintilt_dist}
    \end{centering}
    \script{plot_iid_spintilt.py}
\end{figure}

Figure \ref{fig:iid_spintilt_dist} shows the inferred spin magnitude distribution with the IID spin B-Spline model, compared with the \textsc{Default} model from \citet{o3b_astro_dist}. 
The B-Spline inferences have large uncertainties but start to show the same features as found and discussed in \citet{spinitasyoulike}. 
We find a distribution that instead of intrinsically peaking at $\cos{\theta}=1$, is found to peak at: $\cos{\theta}=$\result{$\CIPlusMinus{\macros[BSplineIIDCompSpins][peakCosTilt]}$}, at 
90\% credibility. We find less, but still considerable support for misaligned spins (i.e. $\cos{\theta}<0$), compared to the \textsc{Default} model. Specifically we 
find that the fraction of misaligned systems is $f_{\cos{\theta}<0}=$\result{$\CIPlusMinus{\macros[BSplineIIDCompSpins][negFrac]}$}. This implies 
the presence of an isotropic component as expected by dynamical formation channels, albeit less than with the \textsc{Default} model. To quantify the 
amount of isotropy in the tilt distribution we calculate $\log_{10}Y$, where $Y$ is the ratio of nearly aligned tilts to nearly anti-aligned, 
introduced in \citet{spinitasyoulike} and defined as:
\begin{equation}
    Y \equiv \frac{\int_{0.9}^{1.0} d\cos{\theta} p(\cos{\theta})}{\int_{-1.0}^{-0.9} d\cos{\theta} p(\cos{\theta})}.
\end{equation}
The log this quantity, $\log_{10}Y$, is 0 for tilt distribution that is purely isotropic, negative when anti-aligned values are favored, 
and positive when aligned tilts are favored. We find a $\log_{10}Y=$\result{$\CIPlusMinus{\macros[BSplineIIDCompSpins][log10gammaFrac]}$}, exhibiting a slight preference for aligned tilts.  

We also model each component's orientation distribution with an independent B-Spline model as done above, and show the inferred 
primary (orange), and secondary (olive) distributions in figure \ref{fig:ind_spintilt_dist}. The orientation distributions are broadly
consistent with each other and the \textsc{Default} model's PPD given the wide credible intervals. We find the two distributions to peak at: $\cos{\theta_1}=$\result{$\CIPlusMinus{\macros[BSplineIndependentCompSpins][peakCosTilt1]}$} 
and $\cos{\theta_2}=$\result{$\CIPlusMinus{\macros[BSplineIndependentCompSpins][peakCosTilt2]}$}, showing that the primary distribution peak is inferred further away 
from the assumed $\cos{\theta}=1$ with the \textsc{Default} model. There is also significant (albeit uncertain) evidence of spin misalignment in each distribution, finding 
the fraction of misaligned primary and secondary components as: $f_{\cos{\theta_1}<0}=$\result{$\CIPlusMinus{\macros[BSplineIndependentCompSpins][negFrac1]}$} and 
$f_{\cos{\theta_2}<0}=$\result{$\CIPlusMinus{\macros[BSplineIndependentCompSpins][negFrac2]}$}. We again calculate $\log_{10}Y$  
for each component distribution and find: $\log_{10}Y_1=$\result{$\CIPlusMinus{\macros[BSplineIndependentCompSpins][log10gammaFrac1]}$} and 
$\log_{10}Y_2=$\result{$\CIPlusMinus{\macros[BSplineIndependentCompSpins][log10gammaFrac2]}$}.

\begin{figure}
    \begin{centering}
        \includegraphics[width=\linewidth]{figures/ind_spintilt.pdf}
        \caption{The primary (orange) and secondary (olive) spin orientation distributions inferred with the B-Spline model with 16 knots spaced linearly from -1 to 1. The solid line shows the population predictive distribution (PPD), and the shaded region the 90\% credible interval. 
        For comparison we show the inferred PPD from the \textsc{Default} (blue) model from \citet{o3b_astro_dist}, the LVK's GWTC-3 population analyses.}
        \label{fig:ind_spintilt_dist}
    \end{centering}
    \script{plot_ind_spintilt.py}
\end{figure}

\subsection{The Effective Spin Dimension}

\begin{figure} 
    \begin{centering}
        \includegraphics[width=\linewidth]{figures/chi_eff.pdf}
        \caption{The effective spin distribution inferred with the B-Spline IID spin model (red). The solid line shows the population predictive distribution (PPD), and the shaded region the 90\% credible interval. We show the inferred $\chi_\mathrm{eff}$ 
        PPD from the independent component spin B-Spline model (purple), and both the \textsc{Default} (blue) model and the 
        Gaussian $\chi_\mathrm{eff}$ (green) model from \citet{o3b_astro_dist}, the LVK's GWTC-3 population analyses.}
        \label{fig:chieff_dist}
    \end{centering}
    \script{plot_chieff.py}
\end{figure}

While the component spin magnitudes and tilts are more directly tied to formation physics, they are typically poorly measured.  The best-measured spin quantity, which enters at the highest post-Newtownian order, is the effective spin: $\chi_\mathrm{eff} = \frac{a_1\cos{\theta_1} + qa_2\cos{\theta_2}}{1+q}$. Figure \ref{fig:chieff_dist} 
shows the inferred effective spin distribution with the two versions of our B-Spline models (red and purple), 
along with results on the \textsc{Default} and \textsc{Gaussian} models from \citet{o3b_astro_dist}. We find considerable agreement 
among the effective spin distributions, but the more flexible B-Spline models in component spins more closely resemble results form the \textsc{Gaussian} model that directly models $\chi_\mathrm{eff}$, than the \textsc{Default} model. This could indicate that the population fit is driven by $\chi_\mathrm{eff}$ 
more than the component spin dimensions. The B-Spline model finds very similar shapes to the other models, with a peak centered at 
$\chi_\mathrm{eff}=$\result{$\CIPlusMinus{\macros[ChiEffective][iid][PeakChiEff]}$}, compared to 
$\chi_\mathrm{eff}=$\result{$\CIPlusMinus{\macros[ChiEffective][default][PeakChiEff]}$} with the \textsc{Default} model and 
$\chi_\mathrm{eff}=$\result{$\CIPlusMinus{\macros[ChiEffective][gaussian][PeakChiEff]}$} with the \textsc{Gaussian} $\chi_\mathrm{eff}$ model. 
As for spin misalignment, we calculate the fraction of systems with effective spins that are misaligned (i.e. $\chi_\mathrm{eff}<0$) and 
find for the B-Spline model $f_{\chi_\mathrm{eff}<0}=$\result{$\CIPlusMinus{\macros[ChiEffective][iid][FracBelow0]}$}, compared to 
$f_{\chi_\mathrm{eff}<0}=$\result{$\CIPlusMinus{\macros[ChiEffective][default][FracBelow0]}$} with the \textsc{Default} model and 
$f_{\chi_\mathrm{eff}<0}=$\result{$\CIPlusMinus{\macros[ChiEffective][gaussian][FracBelow0]}$} with the Gaussian $\chi_\mathrm{eff}$ model.

\begin{figure}[h]
    \includegraphics[width=\linewidth]{figures/rate_vs_z_plot.pdf}
    \caption{The BBH merger rate as a function of redshift. We show the B-Spline model (red), with 16 knots spaced linearly in $\log(z)$, 
    from the minimum to the maximum observed redshifts. The solid line shows the population predictive distribution (PPD) and the shaded region, 
    the 90\% credible interval. We show the inferred 90\% credible interval from the \textsc{PowerlawRedshift} model 
    from the LVK's GWTC-3 population analyses in blue and a power law with exponent of 2.7 in gray, representing the expected star formation rate 
    \citep{Madau_2014, o3b_astro_dist}.}
    \label{fig:rofz}
    \script{rate_vs_z_plot.py}
\end{figure}

\subsection{Binary Black Hole Merger Rates}

Recent analysis of the GWTC-3 BBH population has shown confident evidence for an increasing merger rate with redshift, nearly ruling out a merger rate that is 
constant with co-moving volume \citep{Fishbach_2018redshift,o3b_astro_dist}. When extending the power law form of the previously used model to have a modulation 
that we model with B-Splines, the merger rate as a function of redshift in figure \ref{fig:rofz}, shows mild support for features departing from the underlying power law. 
In particular, we see a small increase in merger rate from $z\sim0.09$ to $z\sim0.2$ (where we best constrain the rate), followed by a plateau in the rate increase from $z\sim0.2$ to $z\sim0.4$. 
At larger redshifts, where we begin to have sparse observations, we see no sign of departure from the power-law as the rate continues to increase with redshift. 
The underlying power-law slope of our modulated B-Spline model is very similar to the GWTC-3 results with the underlying model by itself: the \textsc{PowerlawRedshift} model 
found $\lambda_z = $\result{$\CIPlusMinus{\macros[PLPeak][lamb]}$} when inferred with the \textsc{PowerlawPeak} mass, and \textsc{Default} spin models. Our more 
flexible model infers a power law slope of $\lambda_z = $\result{$\CIPlusMinus{\macros[BSplineIIDCompSpins][lamb]}$}. We show the basis spline modulations or departure 
from the power law in \ref{fig:z_modulation} compared to the prior -- showing where we can constrain deviations from the simpler parametric model. 
The extra freedom of our model does inflate the rate estimates, especially at $z\sim0$ where we don't have any observations. We find a local ($z=0$) merger rate 
of $\mathcal{R}_0 = $\result{$\CIPlusMinus{\macros[BSplineIIDCompSpins][local_rate]}$} for the B-Spline modulation model which compares to 
$\mathcal{R}_0 = $\result{$\CIPlusMinus{\macros[PLPeak][local_rate]}$} for the GWTC-3 result. 

\begin{figure}[h]
    \includegraphics[width=\linewidth]{figures/z_modulation_plot.pdf}
    \caption{The B-Spline modulation to the underlying power law in redshift, (red). The solid line shows the population predictive distribution (PPD) 
    and the shaded region, the 90\% credible interval. We show the 90\% credible interval of the prior predictive distribution in dashed black lines.}
    \label{fig:z_modulation}
    \script{z_modulation_plot.py}
\end{figure}